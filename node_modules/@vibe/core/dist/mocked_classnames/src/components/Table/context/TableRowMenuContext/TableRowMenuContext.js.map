{"version":3,"file":"TableRowMenuContext.js","sources":["../../../../../../../src/components/Table/context/TableRowMenuContext/TableRowMenuContext.tsx"],"sourcesContent":["import React, { createContext, useCallback, useContext, useMemo, useRef, useState } from \"react\";\nimport { TableRowMenuContext as ITableRowMenuContext, TableRowMenuProviderProps } from \"./TableRowMenuContext.types\";\n\nconst TableRowMenuContext = createContext<ITableRowMenuContext | undefined>(undefined);\n\nexport const TableRowMenuProvider = ({ value, children }: TableRowMenuProviderProps) => {\n  const { tableRootRef, hoveredRowRef, isMenuOpen, resetHoveredRow, setHoveredRowRef, setIsMenuOpen } = value;\n  const rowMouseLeaveTimeoutId = useRef<ReturnType<typeof setTimeout>>(null);\n  const [menuButtonPosition, setMenuButtonPosition] = useState(0);\n\n  const resetTimeout = useCallback(() => {\n    clearTimeout(rowMouseLeaveTimeoutId.current);\n    rowMouseLeaveTimeoutId.current = null;\n  }, []);\n\n  const onMouseOverRow = useCallback(\n    (rowRef: React.RefObject<HTMLDivElement>) => {\n      if (isMenuOpen || hoveredRowRef?.current === rowRef.current) return;\n      resetTimeout();\n      setHoveredRowRef(rowRef);\n      const tableRootTop = tableRootRef.current.getBoundingClientRect().top;\n      const rowTop = rowRef.current.getBoundingClientRect().top;\n      setMenuButtonPosition(rowTop - tableRootTop);\n    },\n    [isMenuOpen, hoveredRowRef, resetTimeout, setHoveredRowRef, tableRootRef]\n  );\n\n  const onMouseLeaveRow = useCallback(() => {\n    if (isMenuOpen) return;\n    rowMouseLeaveTimeoutId.current = setTimeout(() => {\n      setHoveredRowRef(null);\n    }, 400);\n  }, [isMenuOpen, setHoveredRowRef]);\n\n  const onMouseOverRowMenu = useCallback(() => {\n    if (isMenuOpen) return;\n    resetTimeout();\n  }, [isMenuOpen, resetTimeout]);\n\n  const onMouseLeaveRowMenu = useCallback(() => {\n    if (isMenuOpen) return;\n    setHoveredRowRef(null);\n  }, [isMenuOpen, setHoveredRowRef]);\n\n  const contextValue = useMemo<ITableRowMenuContext>(\n    () => ({\n      hoveredRowId: hoveredRowRef?.current?.id,\n      resetHoveredRow,\n      menuButtonPosition,\n      onMouseOverRow,\n      onMouseLeaveRow,\n      onMouseOverRowMenu,\n      onMouseLeaveRowMenu,\n      setTableMenuShown: () => setIsMenuOpen(true),\n      setTableMenuHidden: () => setIsMenuOpen(false)\n    }),\n    [\n      hoveredRowRef,\n      resetHoveredRow,\n      menuButtonPosition,\n      onMouseLeaveRow,\n      onMouseLeaveRowMenu,\n      onMouseOverRow,\n      onMouseOverRowMenu,\n      setIsMenuOpen\n    ]\n  );\n\n  return <TableRowMenuContext.Provider value={contextValue}>{children}</TableRowMenuContext.Provider>;\n};\n\nexport const useTableRowMenu = () => {\n  const context = useContext(TableRowMenuContext);\n  if (!context) {\n    throw new Error(\"useTableRowMenuContext must be used within a TableRowMenuProvider\");\n  }\n  return context;\n};\n"],"names":["TableRowMenuContext","createContext","undefined","TableRowMenuProvider","_ref","value","children","tableRootRef","hoveredRowRef","isMenuOpen","resetHoveredRow","setHoveredRowRef","setIsMenuOpen","rowMouseLeaveTimeoutId","useRef","_useState","useState","_useState2","_slicedToArray","menuButtonPosition","setMenuButtonPosition","resetTimeout","useCallback","clearTimeout","current","onMouseOverRow","rowRef","tableRootTop","getBoundingClientRect","top","rowTop","onMouseLeaveRow","setTimeout","onMouseOverRowMenu","onMouseLeaveRowMenu","contextValue","useMemo","hoveredRowId","_a","id","setTableMenuShown","setTableMenuHidden","React","createElement","Provider","useTableRowMenu","context","useContext","Error"],"mappings":"sMAGA,IAAMA,EAAsBC,OAAgDC,GAE/DC,EAAuB,SAAHC,GAAsD,IAAhDC,EAAKD,EAALC,MAAOC,EAAQF,EAARE,SACpCC,EAA8FF,EAA9FE,aAAcC,EAAgFH,EAAhFG,cAAeC,EAAiEJ,EAAjEI,WAAYC,EAAqDL,EAArDK,gBAAiBC,EAAoCN,EAApCM,iBAAkBC,EAAkBP,EAAlBO,cAC9EC,EAAyBC,EAAsC,MACrEC,EAAoDC,EAAS,GAAEC,EAAAC,EAAAH,EAAA,GAAxDI,EAAkBF,EAAA,GAAEG,EAAqBH,EAAA,GAE1CI,EAAeC,GAAY,WAC/BC,aAAaV,EAAuBW,SACpCX,EAAuBW,QAAU,IAClC,GAAE,IAEGC,EAAiBH,GACrB,SAACI,GACC,IAAIjB,IAAcD,aAAA,EAAAA,EAAegB,WAAYE,EAAOF,QAApD,CACAH,IACAV,EAAiBe,GACjB,IAAMC,EAAepB,EAAaiB,QAAQI,wBAAwBC,IAC5DC,EAASJ,EAAOF,QAAQI,wBAAwBC,IACtDT,EAAsBU,EAASH,EAL8B,CAM/D,GACA,CAAClB,EAAYD,EAAea,EAAcV,EAAkBJ,IAGxDwB,EAAkBT,GAAY,WAC9Bb,IACJI,EAAuBW,QAAUQ,YAAW,WAC1CrB,EAAiB,KAClB,GAAE,KACL,GAAG,CAACF,EAAYE,IAEVsB,EAAqBX,GAAY,WACjCb,GACJY,GACF,GAAG,CAACZ,EAAYY,IAEVa,EAAsBZ,GAAY,WAClCb,GACJE,EAAiB,KACnB,GAAG,CAACF,EAAYE,IAEVwB,EAAeC,GACnB,iBAAM,MAAC,CACLC,aAAoC,QAAtBC,EAAA9B,eAAAA,EAAegB,eAAO,IAAAc,OAAA,EAAAA,EAAEC,GACtC7B,gBAAAA,EACAS,mBAAAA,EACAM,eAAAA,EACAM,gBAAAA,EACAE,mBAAAA,EACAC,oBAAAA,EACAM,kBAAmB,WAAA,OAAM5B,GAAc,EAAK,EAC5C6B,mBAAoB,WAAA,OAAM7B,GAAc,EAAM,KAEhD,CACEJ,EACAE,EACAS,EACAY,EACAG,EACAT,EACAQ,EACArB,IAIJ,OAAO8B,EAAAC,cAAC3C,EAAoB4C,SAAQ,CAACvC,MAAO8B,GAAe7B,EAC7D,EAEauC,EAAkB,WAC7B,IAAMC,EAAUC,EAAW/C,GAC3B,IAAK8C,EACH,MAAUE,MAAM,qEAElB,OAAOF,CACT"}