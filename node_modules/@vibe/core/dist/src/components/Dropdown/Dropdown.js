import{slicedToArray as e,defineProperty as n,toConsumableArray as o}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{getTestId as t,ComponentDefaultTestId as r}from"../../tests/testIds.js";import i from"classnames";import{BaseSizes as a}from"../../constants/sizes.js";import s,{forwardRef as l,useRef as u,useMemo as c,useState as d,useEffect as p,useCallback as m}from"react";import f,{createFilter as O,components as v}from"react-select";import b from"react-select/async";import g from"react-select/base";import{noop as j}from"lodash-es";import C from"./components/menu/menu.js";import M from"./components/DropdownIndicator/DropdownIndicator.js";import w from"./components/option/option.js";import y from"./components/singleValue/singleValue.js";import h from"./components/ClearIndicator/ClearIndicator.js";import S from"./components/MultiValueContainer/MultiValueContainer.js";import{isClient as I}from"../../utils/ssr-utils.js";import{DROPDOWN_CHIP_COLORS as V,DROPDOWN_MENU_PLACEMENT as D,DROPDOWN_MENU_POSITION as R,ADD_AUTO_HEIGHT_COMPONENTS as P,defaultCustomStyles as W,DROPDOWN_ID as A,DROPDOWN_MENU_ID as L,DROPDOWN_MENU_ARIA_LABEL as E,DROPDOWN_INPUT_ARIA_LABEL as N}from"./DropdownConstants.js";import x,{customTheme as z}from"./Dropdown.styles.js";import F from"./components/Control/Control.js";import T from"./components/menu/menu.module.scss.js";import B from"./Dropdown.module.scss.js";import{withStaticProps as k}from"../../types/withStaticProps.js";import"../../utils/colors-vars-map.js";var H=k(l((function(a,l){var O=a.className,V=a.optionWrapperClassName,D=a.singleValueWrapperClassName,R=a.dropdownMenuWrapperClassName,k=a.placeholder,H=void 0===k?"":k,_=a.disabled,q=void 0!==_&&_,G=a.readOnly,K=void 0!==G&&G,J=a.onMenuOpen,Q=void 0===J?j:J,U=a.onMenuClose,X=void 0===U?j:U,Y=a.onFocus,Z=void 0===Y?j:Y,$=a.onBlur,ee=void 0===$?j:$,ne=a.onScroll,oe=void 0===ne?j:ne,te=a.onMenuScrollToBottom,re=void 0===te?j:te,ie=a.onChange,ae=void 0===ie?j:ie,se=a.searchable,le=void 0===se||se,ue=a.captureMenuScroll,ce=void 0!==ue&&ue,de=a.options,pe=void 0===de?[]:de,me=a.defaultValue,fe=a.value,Oe=a.noOptionsMessage,ve=a.openMenuOnFocus,be=a.openMenuOnClick,ge=a.clearable,je=void 0===ge||ge,Ce=a.OptionRenderer,Me=a.optionRenderer,we=a.ValueRenderer,ye=a.valueRenderer,he=a.menuRenderer,Se=a.menuPlacement,Ie=void 0===Se?"bottom":Se,Ve=a.rtl,De=a.size,Re=void 0===De?"medium":De,Pe=a.asyncOptions,We=a.cacheOptions,Ae=a.defaultOptions,Le=a.isVirtualized,Ee=a.menuPortalTarget,Ne=a.extraStyles,xe=void 0===Ne?W:Ne,ze=a.maxMenuHeight,Fe=a.menuIsOpen,Te=a.tabIndex,Be=void 0===Te?"0":Te,ke=a.id,He=void 0===ke?A:ke,_e=a.menuId,qe=void 0===_e?L:_e,Ge=a.menuAriaLabel,Ke=void 0===Ge?E:Ge,Je=a.inputAriaLabel,Qe=void 0===Je?N:Je,Ue=a.autoFocus,Xe=void 0!==Ue&&Ue,Ye=a.multi,Ze=void 0!==Ye&&Ye,$e=a.multiline,en=void 0!==$e&&$e,nn=a.onOptionRemove,on=a.onOptionSelect,tn=a.onClear,rn=a.onInputChange,an=void 0===rn?j:rn,sn=a.closeMenuOnSelect,ln=void 0===sn?!Ze:sn,un=a.closeMenuOnScroll,cn=void 0!==un&&un,dn=a.withMandatoryDefaultOptions,pn=void 0!==dn&&dn,mn=a.isOptionSelected,fn=a.insideOverflowContainer,On=void 0!==fn&&fn,vn=a.insideOverflowWithTransformContainer,bn=void 0!==vn&&vn,gn=a.tooltipContent,jn=void 0===gn?"":gn,Cn=a.onKeyDown,Mn=void 0===Cn?j:Cn,wn=a.isLoading,yn=void 0!==wn&&wn,hn=a.loadingMessage,Sn=a.ariaLabel,In=a.tabSelectsValue,Vn=void 0===In||In,Dn=a.popupsContainerSelector,Rn=a.filterOption,Pn=a.menuPosition,Wn=void 0===Pn?"absolute":Pn,An=a["data-testid"],Ln=a.withGroupDivider,En=void 0!==Ln&&Ln,Nn=a.inputValue,xn=a.blurInputOnSelect,zn=u(),Fn=Ee||Dn&&document.querySelector(Dn),Tn=c((function(){return me?Array.isArray(me)?me.map((function(e){return Object.assign(Object.assign({},e),{isMandatory:!0})})):Object.assign(Object.assign({},me),{isMandatory:!0}):me}),[me]);g.prototype.renderLiveRegion=function(){return null};var Bn=d(null),kn=e(Bn,2),Hn=kn[0],_n=kn[1];p((function(){if(I())if("test"===process.env.NODE_ENV){var e=require("react-windowed-select");_n((function(){return e.WindowedMenuList}))}else import("react-windowed-select").then((function(e){_n((function(){return e.WindowedMenuList}))}))}),[]);var qn=d(Tn||[]),Gn=e(qn,2),Kn=Gn[0],Jn=Gn[1],Qn=d(""),Un=e(Qn,2),Xn=Un[0],Yn=Un[1],Zn=Me||Ce,$n=ye||we,eo=!!fe,no=null!=fe?fe:Kn,oo=c((function(){return Array.isArray(no)?no.reduce((function(e,o){return Object.assign(Object.assign({},e),n({},o.value,o))}),{}):{}}),[no]),to=c((function(){return Sn||"".concat(K?"Readonly ":""," ").concat(jn," ").concat(Array.isArray(no)?"Selected: ".concat(no.map((function(e){return e.label})).join(", ")):"Select")}),[Sn,K,no,jn]),ro=Ze?no:fe,io=c((function(){var o=x({size:Re,rtl:Ve,insideOverflowContainer:On,controlRef:zn,insideOverflowWithTransformContainer:bn,withGroupDivider:En}),t=xe(o),r=Object.entries(t).reduce((function(t,r){var i=e(r,2),a=i[0],s=i[1];return Object.assign(Object.assign({},t),n({},a,(function(e,n){var t=o[a],r=t?t(e,n):e;return s(r,n)})))}),{});if(Ze){en&&P.forEach((function(e){var n=r[e];r[e]=function(e,o){return Object.assign(Object.assign({},n(e,o)),{height:"auto"})}}));var i=r.valueContainer;r.valueContainer=function(e,n){return Object.assign(Object.assign({},i(e,n)),{paddingLeft:6})}}return r}),[Re,Ve,On,bn,xe,Ze,en]),ao=m((function(e){return s.createElement(C,Object.assign({},e,{id:qe,ariaLabel:Ke,Renderer:he,dropdownMenuWrapperClassName:R,onScroll:oe}))}),[R,he,qe,Ke,oe]),so=m((function(e){return s.createElement(M,Object.assign({},e,{size:Re}))}),[Re]),lo=m((function(e){return s.createElement(w,Object.assign({setFocusedOptionId:Yn},e,{Renderer:Zn,optionWrapperClassName:V}))}),[Zn,V,Yn]),uo=m((function(e){var n=e.selectProps,o=n.focusedOptionId,t=n.menuIsOpen;return s.createElement(v.Input,Object.assign({},e,{"aria-activedescendant":o&&t?o:"",role:"combobox","aria-expanded":!K&&t,"aria-label":Qe,"aria-controls":qe}))}),[qe,K]),co=m((function(e){return s.createElement(y,Object.assign({},e,{readOnly:K,Renderer:$n,selectedOption:no[0],singleValueWrapperClassName:D}))}),[$n,K,no,D]),po=m((function(e){return s.createElement(h,Object.assign({},e,{size:Re}))}),[Re]),mo=c((function(){return function(e,n){nn&&nn(oo[e]);var o=Array.isArray(no)?no.filter((function(n){return n.value!==e})):no;ae&&ae(o,n),Jn(o)}}),[ae,nn,no,oo]),fo=c((function(){return{selectedOptions:no,onSelectedDelete:mo,isMultiline:en,insideOverflowContainer:On,insideOverflowWithTransformContainer:bn,controlRef:zn,tooltipContent:jn,popupsContainerSelector:Dn,size:Re}}),[no,mo,en,On,bn,jn,Dn,Re]),Oo=Pe?b:f,vo=Object.assign({},Pe&&Object.assign({loadOptions:Pe,cacheOptions:We},Ae&&{defaultOptions:Ae})),bo=Object.assign(Object.assign({},!Pe&&{options:pe}),Ze&&{isMulti:!0}),go=m((function(e){var n,o=e.target;return!(null===(n=null==o?void 0:o.parentElement)||void 0===n?void 0:n.classList.contains(T.dropdownMenuWrapper))&&(cn||On||bn)}),[On,bn,cn]);return s.createElement(Oo,Object.assign({className:i(B.dropdown,O),selectProps:fo,components:Object.assign(Object.assign({DropdownIndicator:so,Menu:ao,ClearIndicator:po,Input:uo,Option:lo,Control:F,SingleValue:co},Ze&&{MultiValue:j,ValueContainer:S}),Le&&Hn&&{MenuList:Hn}),closeMenuOnScroll:go,size:Re,noOptionsMessage:Oe,placeholder:H,isDisabled:q,isClearable:!K&&je,isSearchable:!K&&le,readOnly:K,"aria-readonly":K,"aria-label":to,"aria-details":jn,"aria-haspopup":"listbox",defaultValue:me,value:ro,onMenuOpen:Q,onMenuClose:X,onFocus:Z,onBlur:ee,onMenuScrollToBottom:re,captureMenuScroll:ce,onChange:function(e,n){switch(ae&&ae(e,n),n.action){case"select-option":var t=Ze?n.option:e;on&&on(t),eo||Jn([].concat(o(no),[t]));break;case"clear":tn&&tn(),eo||Jn(pn?Tn:[])}},onKeyDown:Mn,onInputChange:an,openMenuOnFocus:ve,openMenuOnClick:be,focusedOptionId:Xn,isRtl:Ve,styles:io,theme:z,maxMenuHeight:ze,menuPortalTarget:Fn,menuPlacement:Ie,menuPosition:Wn,menuIsOpen:!K&&Fe,tabIndex:Be,id:He,"data-testid":An||t(r.DROPDOWN,He),autoFocus:Xe,closeMenuOnSelect:ln,ref:l,withMandatoryDefaultOptions:pn,isOptionSelected:mn,isLoading:yn,loadingMessage:hn,tabSelectsValue:Vn,filterOption:Rn,inputValue:Nn,blurInputOnSelect:xn},vo,bo))})),{sizes:a,chipColors:V,menuPlacements:D,menuPositions:R,createFilter:O});export{H as default};
//# sourceMappingURL=Dropdown.js.map
